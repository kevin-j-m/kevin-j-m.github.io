<!doctype html>

<html lang="en">

<head>
  <title>Kevin Murphy</title>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="Kevin Murphy: Software Developer" />
<meta name="author" content="Kevin Murphy" /><meta property="og:title" content="Diffin&#39; Dots" />
<meta property="og:description" content="Git comparisons of the future&hellip;today!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kevin-j-m.github.io/posts/diffin-dots/" />
<meta property="article:published_time" content="2019-12-30T21:04:53-05:00" />
<meta property="article:modified_time" content="2019-12-30T21:04:53-05:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Diffin&#39; Dots"/>
<meta name="twitter:description" content="Git comparisons of the future&hellip;today!"/>

<meta name="generator" content="Hugo 0.62.0" />
    

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://kevin-j-m.github.io/fontawesome/css/all.min.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  <link rel="stylesheet" type="text/css" href="https://kevin-j-m.github.io/css/styles.css" /><link rel='stylesheet' href='https://kevin-j-m.github.io/css/code-scroll.css'></head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="https://kevin-j-m.github.io/">Kevin Murphy</a>
            </h1>

      <ul id="social-media">
             <li>
               <a href="https://github.com/kevin-j-m" title="GitHub">
               <i class="fab fa-github fa-lg"></i>
               </a>
             </li>
             <li>
               <a href="https://twitter.com/kevin_j_m" title="Twitter">
               <i class="fab fa-twitter fa-lg"></i>
               </a>
             </li>
             <li>
               <a href="https://linkedin.com/in/kevinmurphydev" title="LinkedIn">
               <i class="fab fa-linkedin fa-lg"></i>
               </a>
             </li>
      </ul>
      
      <p><em>Musings of a Boston-based Software Developer</em></p>
      
    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="" href="https://kevin-j-m.github.io/">
                <i class="fa-li fa  fa-lg"></i><span>Home</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://kevin-j-m.github.io/about/">
                <i class="fa-li fa  fa-lg"></i><span>About</span>
            </a>
        </li>
        
    </ul>
</nav>

    <main>




<article>

    <h1>Diffin&#39; Dots</h1>

    
        <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2019-12-30T21:04:53-05:00">Dec 30, 2019</time>
        </li>
        

        
        <li>
            <em>
                
                    
                    <a href="https://kevin-j-m.github.io/tags/git">#git</a>
                
            </em>
        </li>
        

        <li>6 minutes read</li>
    </ul>
</aside>

    

    <h2 id="a-sweet-surprise">A Sweet Surprise</h2>
<p>Recently, a project needed to re-order some commits on a git branch. We
initially performed this interactive rebase on a separate branch, so we didn't
make a mistake on the original branch. After performing that rebase, we then
used Github's <a href="https://help.github.com/en/github/committing-changes-to-your-project/comparing-commits-across-time#comparing-branches">compare view</a>, expecting to see no files changed.</p>
<p>Instead, what we saw was every change that was introduced in all of the commits
that were reordered on the new branch. This very much surprised us. We made no
functional changes and were expecting to use this comparison as proof that we
didn't accidentally drop a commit or do something terrible on accident.</p>
<p>We then looked to compare the branches locally. When we did that, we saw no
diff.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">⇒ diff-test|reorder git diff master

<span style="color:#f92672">(</span>END<span style="color:#f92672">)</span>
</code></pre></div><p>Did we find a bug in Github? Did our re-ordering work? At this point, we had no
idea.</p>
<h2 id="read-the-recipe">Read The Recipe</h2>
<p>We dug into the documentation for <code>diff</code>, a tool I use frequently,
but don't spend much time considering how it works.</p>
<p>Let's read some of the help on how to use the diff tool:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">⇒ git diff --help
GIT-DIFF<span style="color:#f92672">(</span>1<span style="color:#f92672">)</span>                                      Git Manual                                      GIT-DIFF<span style="color:#f92672">(</span>1<span style="color:#f92672">)</span>
...
       git diff <span style="color:#f92672">[</span>&lt;options&gt;<span style="color:#f92672">]</span> &lt;commit&gt; <span style="color:#f92672">[</span>--<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>&lt;path&gt;...<span style="color:#f92672">]</span>
           This form is to view the changes you have in your working tree relative to the named &lt;commit&gt;.
           You can use HEAD to compare it with the latest commit, or a branch name to compare with the tip
           of a different branch.

       git diff <span style="color:#f92672">[</span>&lt;options&gt;<span style="color:#f92672">]</span> &lt;commit&gt; &lt;commit&gt; <span style="color:#f92672">[</span>--<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>&lt;path&gt;...<span style="color:#f92672">]</span>
           This is to view the changes between two arbitrary &lt;commit&gt;.

       git diff <span style="color:#f92672">[</span>&lt;options&gt;<span style="color:#f92672">]</span> &lt;commit&gt;..&lt;commit&gt; <span style="color:#f92672">[</span>--<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>&lt;path&gt;...<span style="color:#f92672">]</span>
           This is synonymous to the previous form. If &lt;commit&gt; on one side is omitted, it will have the
           same effect as using HEAD instead.

       git diff <span style="color:#f92672">[</span>&lt;options&gt;<span style="color:#f92672">]</span> &lt;commit&gt;...&lt;commit&gt; <span style="color:#f92672">[</span>--<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>&lt;path&gt;...<span style="color:#f92672">]</span>
           This form is to view the changes on the branch containing and up to the second &lt;commit&gt;, starting
           at a common ancestor of both &lt;commit&gt;.
</code></pre></div><p>Almost exclusively I've used diff in the form of <code>git diff other-ref</code>. And
with that, I would see what, if any, file changes occurred between those two
branches or commits. This is the two-dot comparison. However, Github uses the
<a href="https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons">three-dot comparison</a>
by default.</p>
<p>In this scenario, the common ancestor is the latest commit on the reordering
branch that wasn't reordered. After the rebase, all of those reordered commits
have different SHAs, so are seen as different commits. As such, using the
three-dot option, git considers all of those SHAs as different or new, so all of
them show as changes, even though there are no differences in the file contents
themselves.</p>
<h2 id="homemade-flavor">Homemade Flavor</h2>
<p>Let's look at demonstrating this behavior entirely locally.</p>
<h3 id="setup">Setup</h3>
<p>First, let's create a new repository:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">⇒ mkdir diff-test
⇒ cd diff-test
diff-test|⇒ git init .
Initialized empty Git repository
</code></pre></div><p>We'll start by adding a few new files, and making the first commit:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">diff-test|master ⇒ echo <span style="color:#e6db74">&#34;Creamy Vanilla Ice Cream done Dippin’ Dots style&#34;</span> &gt; vanilla.txt
diff-test|master⚡ ⇒ echo <span style="color:#e6db74">&#34;Creamy Milk Chocolate Ice Cream.  Someone pass the spoon&#34;</span> &gt; chocolate.txt
diff-test|master⚡ ⇒ git add --all
diff-test|master⚡ ⇒ git commit -m <span style="color:#e6db74">&#34;IFO: initial flavor offering&#34;</span>
</code></pre></div><p>We will then add two more commits with some additional changes:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">diff-test|master ⇒ echo <span style="color:#e6db74">&#34;Dippin&#39; Dots Strawberry Ice Cream is as sweet as a summer&#39;s day and so berry, berry good&#34;</span> &gt; strawberry.txt
diff-test|master⚡ ⇒ git add --all
diff-test|master⚡ ⇒ git commit -m <span style="color:#e6db74">&#34;Introducing strawberry&#34;</span>

diff-test|master ⇒ echo <span style="color:#e6db74">&#34;Orange Flavored Ice&#34;</span> &gt; orange.txt
diff-test|master⚡ ⇒ git add --all
diff-test|master⚡ ⇒ git commit -m <span style="color:#e6db74">&#34;Introducing orange&#34;</span>
</code></pre></div><h3 id="introduce-a-change">Introduce a change</h3>
<p>At this point, we realize that it's important to us that orange be introduced in
our history before strawberry.</p>
<p>Let's create a new branch to address this, and look at the current order of the
commits:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">diff-test|master ⇒ git checkout -b reorder
Switched to a new branch <span style="color:#e6db74">&#39;reorder&#39;</span>
diff-test|reorder ⇒ git log --oneline

e378256 <span style="color:#f92672">(</span>HEAD -&gt; reorder, master<span style="color:#f92672">)</span> Introducing orange
f455e5b Introducing strawberry
e42566b IFO: initial flavor offering
</code></pre></div><p>We will then perform an interactive rebase, going back two commits in history.
During that rebase, we will switch the order of orange and strawberry, so orange
is first, as we need it:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">diff-test|reorder ⇒ git rebase -i HEAD~2

pick e378256 Introducing orange
pick f455e5b Introducing strawberry
</code></pre></div><p>After performing the rebase, here is the order of our commits:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">diff-test|reorder ⇒ git log --oneline

5fa36f4 <span style="color:#f92672">(</span>HEAD -&gt; reorder<span style="color:#f92672">)</span> Introducing strawberry
7a1d500 Introducing orange
e42566b IFO: initial flavor offering
</code></pre></div><p>Congratulations! We've done what we set out to do, performing a rebase to
reorder our commits. Now let's compare that to our original branch to make sure
everything looks to be as we'd expect.</p>
<h3 id="differences"><code>diff</code>erences</h3>
<p>We start by comparing this branch to the original branch:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">diff-test|reorder ⇒ git diff master

<span style="color:#f92672">(</span>END<span style="color:#f92672">)</span>
</code></pre></div><p>We see that there's no difference, which we're expecting and hoping for. No
files changed, no functionality is different; only the history has changed.</p>
<p>If we diff using the two-dot version, we see the same result:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">diff-test|reorder ⇒ git diff master..reorder

<span style="color:#f92672">(</span>END<span style="color:#f92672">)</span>
</code></pre></div><p>That sounds right, because according to the documentation, the two-dot usage is
the same as not providing dots:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> git diff <span style="color:#f92672">[</span>&lt;options&gt;<span style="color:#f92672">]</span> &lt;commit&gt;..&lt;commit&gt; <span style="color:#f92672">[</span>--<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>&lt;path&gt;...<span style="color:#f92672">]</span>
          This is synonymous to the previous form. If &lt;commit&gt; on one side is omitted, it will have the
          same effect as using HEAD instead.
</code></pre></div><p>Lastly, let's perform a three-dot diff:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">diff-test|reorder ⇒ git diff master...reorder

diff --git a/orange.txt b/orange.txt
new file mode <span style="color:#ae81ff">100644</span>
index 0000000..09d8732
--- /dev/null
+++ b/orange.txt
@@ -0,0 +1 @@
+Orange Flavored Ice
diff --git a/strawberry.txt b/strawberry.txt
new file mode <span style="color:#ae81ff">100644</span>
index 0000000..6ab358d
--- /dev/null
+++ b/strawberry.txt
@@ -0,0 +1 @@
+Dippin<span style="color:#e6db74">&#39; Dots Strawberry Ice Cream is as sweet as a summer&#39;</span>s day and so berry, berry good
<span style="color:#f92672">(</span>END<span style="color:#f92672">)</span>
</code></pre></div><p>Here is where we see that it looks like each of those files have been changed as
a result of this rebase. However, the files themselves <strong>haven't</strong> changed. What
has is the commits themselves. Their common ancestor is the initial commit of
the repository, so everything that happened since then shows as a difference.</p>
<h2 id="the-cherry-on-top">The Cherry On Top</h2>
<p>Locally, unless you tell git otherwise, <code>diff</code> will show you the file change
differences between your comparisons. Github by default will show you the
changes from the common ancestor between what's changed.</p>
<p>Most of the time, this different behavior won't or shouldn't matter in the
course of your workflow. However, if you're doing something a bit more
adventurous, or perhaps ill-advised, knowing how git will, by default, compare
changes locally and how Github, by default, will surface those changes can be
paramount.</p>
<blockquote>
<p>This post originally published on <a href="https://blog.thegnar.co/diffin-dots">The Gnar Company blog</a>.</p>
</blockquote>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="https://kevin-j-m.github.io/posts/rubyconf-2019/"><i class="fa fa-chevron-circle-left"></i> Don’t Hang Me Out To DRY</a>
        </li>
        
        
        <li>
            <a href="https://kevin-j-m.github.io/posts/coding-for-fun-not-profit/">Coding for Fun (Not Profit) <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
    
    





</main>
    <footer>
        <h6>Copyright © 2020 - Kevin Murphy |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="https://kevin-j-m.github.io/index.xml">Subscribe </a></h6>
    </footer>
</div>
<script src="https://kevin-j-m.github.io/js/scripts.js"></script>

</body>

</html>

